title=<h1 align="center">A6-Sensitive Data Exposure</h1>
description=<h2 align="center">A general description of the problem</h2>Many web applications do not properly protect sensitive data, such as credit cards, tax IDs, and authentication credentials. Attackers may steal or modify such weakly protected data to conduct credit card fraud, identity theft, or other crimes. Sensitive data deserves extra protection such as encryption at rest or in transit, as well as special precautions when exchanged with the browser.
impact=<h2 align="center">Outline typical impact of attacks exploiting that weakness</h2><p><b>Am I Vulnerable To 'Sensitive Data Exposure'?</b></p><p align="justify">The first thing you have to determine is which data is sensitive enough to require extra protection. For example, passwords, credit card numbers, health records, and personal information should be protected. For all such data:</p><ol><li>Is any of this data stored in clear text long term, including backups of this data?</li><li>Is any of this data transmitted in clear text, internally or externally? Internet traffic is especially dangerous.</li><li>Are any old / weak cryptographic algorithms used?</li><li>Are weak crypto keys generated, or is proper key management or rotation missing?</li><li>Are any browser security directives or headers missing when sensitive data is provided by / sent to the browser?</li></ol><p>And more \u2026 For a more complete set of problems to avoid, see ASVS areas Crypto (V7), Data Prot. (V9), and SSL (V10)</p>
scenario=<h2 align="center">Example Attack Scenarios</h2><p><b>Scenario #1:</b> An application encrypts credit card numbers in a database using automatic database encryption. However, this means it also decrypts this data automatically when retrieved, allowing an SQL injection flaw to retrieve credit card numbers in clear text. The system should have encrypted the credit card numbers using a public key, and only allowed back-end applications to decrypt them with the private key.</p><p><b>Scenario #2:</b> A site simply doesn\u2019t use SSL for all authenticated pages. Attacker simply monitors network traffic (like an open wireless network), and steals the user\u2019s session cookie. Attacker then replays this cookie and hijacks the user\u2019s session, accessing the user\u2019s private data.</p><p><b>Scenario #3:</b> The password database uses unsalted hashes to store everyone\u2019s passwords. A file upload flaw allows an attacker to retrieve the password file. All of the unsalted hashes can be exposed with a rainbow table of precalculated hashes.</p>
avoid=<h2 align="center">Outline how the weakness can be avoided</h2><p><b>How Do I Prevent 'Sensitive Data Exposure'?</b></p><p><b><p>The full perils of unsafe cryptography, SSL usage, and data protection are well beyond the scope of the Top 10. That said, for all sensitive data, do all of the following, at a minimum:</p><ol><li>Considering the threats you plan to protect this data from (e.g., insider attack, external user), make sure you encrypt all sensitive data at rest and in transit in a manner that defends against these threats.</li><li>Don\u2019t store sensitive data unnecessarily. Discard it as soon as possible. Data you don\u2019t have can\u2019t be stolen.</li><li>Ensure strong standard algorithms and strong keys are used, and proper key management is in place. Consider using FIPS 140 validated cryptographic modules.</li><li>Ensure passwords are stored with an algorithm specifically designed for password protection, such as bcrypt, PBKDF2, or scrypt.</li><li>Disable autocomplete on forms collecting sensitive data and disable caching for pages that contain sensitive data.</li></ol>
external_resources=<h2 align="center">Links to external resources for further information</h2><ul><li><a href="http://cwe.mitre.org/data/definitions/310.html">CWE Entry 310 on Cryptographic Issues</a></li><li><a href="http://cwe.mitre.org/data/definitions/312.html">CWE Entry 312 on Cleartext Storage of Sensitive Information</a></li><li><a href="http://cwe.mitre.org/data/definitions/319.html">CWE Entry 319 on Cleartext Transmission of Sensitive Information</a></li><li><a href="http://cwe.mitre.org/data/definitions/326.html">CWE Entry 326 on Weak Encryption</a></li></ul> 